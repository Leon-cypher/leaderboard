<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>樂玩LeaderBoard - 逢甲店積分賽</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Noto Sans TC 字型 -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #f0f2f5;
            font-family: 'Noto Sans TC', 'Segoe UI', 'Roboto', sans-serif;
        }
        .poster-section {
            text-align: center;
            margin-bottom: 2rem;
        }
        .poster-section img {
            max-width: 700px;
            width: 100%;
            height: auto;
            border-radius: 1.2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        .footer {
            text-align: center;
            padding: 2rem 0;
            margin-top: 3rem;
            color: #6c757d;
            font-size: 0.9rem;
            background-color: #e9ecef;
        }
        .table-container { padding: 0 1rem; }
        .table {
            margin-left: auto;
            margin-right: auto;
            max-width: 800px;
        }
        .table th, .table td {
            text-align: center !important;
            vertical-align: middle;
        }
        .level-select-container {
            text-align: right;
            margin-bottom: 1rem;
        }
        .level-select {
            font-size: 1rem;
            padding: 0.25rem 1rem;
            border-radius: 0.5rem;
            border: 1px solid #ccc;
        }
        /* ===== 響應式設計 ===== */
        @media (max-width: 768px) {
            .poster-section img {
                max-width: 100%;
                border-radius: 0.8rem;
            }
            .table {
                font-size: 0.98rem;
            }
        }
        @media (max-width: 480px) {
            .poster-section {
                margin-bottom: 1.2rem;
            }
            .poster-section img {
                border-radius: 0.5rem;
            }
            .table th, .table td {
                font-size: 0.92rem;
                padding: 0.35rem 0.3rem;
            }
            .level-select-container {
                text-align: left;
                margin-bottom: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container" style="margin-top: 2rem; position: relative; z-index: 10;">
        <!-- 頁首標題 -->
        <div class="text-center bg-white p-4 rounded shadow-sm mb-4">
            <h1 style="color: #0056b3;"><strong>LeaderBoard</strong></h1>
            <p class="lead text-muted">樂玩逢甲店 - 積分排行榜 9/1~9/30</p>
        </div>
        <!-- 活動海報區塊（取代積分豪禮、獎品泡泡） -->
        <div class="poster-section text-center mb-4">
            <!-- 請將你的活動海報圖檔命名為 poster.jpg 或更換下方 src -->
            <img src="poster.PNG" alt="活動海報" class="img-fluid">
        </div>
        <!-- 分頁標籤區塊（Tabs） -->
        <ul class="nav nav-tabs mb-4" id="leaderboardTab" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="event-tab" data-bs-toggle="tab" data-bs-target="#event-content" type="button" role="tab" aria-controls="event-content" aria-selected="true">
              活動說明
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="board-tab" data-bs-toggle="tab" data-bs-target="#board-content" type="button" role="tab" aria-controls="board-content" aria-selected="false">
              玩家積分榜
            </button>
          </li>
        </ul>
        <div class="tab-content" id="leaderboardTabContent">
          <!-- 活動說明內容 -->
          <div class="tab-pane fade show active" id="event-content" role="tabpanel" aria-labelledby="event-tab">
            <div class="card mb-4" style="background: #fff9e5;">
              <div class="card-body">
                <h2 class="card-title text-center mb-3 fw-bold" style="color:#b98a33;">LEADER BOARD 積分排行榜活動說明</h2>
                <ul class="mb-3">
                  <li>
                    <b>活動期間：</b>9/1 - 9/30，參加各級別限時錦標賽即可獲得點數。
                  </li>
                  <li>
                    <b>活動辦法：</b>
                    <ul>
                      <li>Buy in / Rebuy / Addon：每次買入分數 <b>1點</b></li>
                      <li>名次分數：賽事前三名額外 <b>+4／+3／+2分</b></li>
                      <li>早鳥/夜貓：15:00前／01:00後 買入賽事，買入分數再加倍</li>
                      <li>活動分組：[1200]、[3400]、[6600以上]（11000以上為2點）</li>
                    </ul>
                  </li>
                </ul>
                <div class="row">
                  <div class="col-md-4 mb-3">
                    <h5 class="fw-bold text-primary">[1200] 名次獎勵<br><small class="text-muted">總價值 $40,000</small></h5>
                    <ol>
                      <li>Switch 2</li>
                      <li>AirPods Pro</li>
                      <li>AirPods 4</li>
                      <li>Choetech 行動電源</li>
                      <li>4000 點數</li>
                      <li>3000 點數</li>
                      <li>2000 點數</li>
                    </ol>
                  </div>
                  <div class="col-md-4 mb-3">
                    <h5 class="fw-bold text-success">[3400] 名次獎勵<br><small class="text-muted">總價值 $60,000</small></h5>
                    <ol>
                      <li>PS5 Pro</li>
                      <li>iPad A16</li>
                      <li>SONY WH-1000XM5</li>
                      <li>AirPods Pro</li>
                      <li>AirPods 4</li>
                      <li>4000 點數</li>
                      <li>3000 點數</li>
                    </ol>
                  </div>
                  <div class="col-md-4 mb-3">
                    <h5 class="fw-bold text-danger">[6600以上] 名次獎勵<br><small class="text-muted">總價值 $100,000</small></h5>
                    <ol>
                      <li>iPhone 17</li>
                      <li>iPad Air M3</li>
                      <li>Harman Kardon Aura Studio 4 無線水母藍牙喇叭</li>
                      <li>SONY WH-1000XM5</li>
                      <li>AirPods Pro</li>
                      <li>AirPods 4</li>
                      <li>4000 點數</li>
                    </ol>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- 玩家積分榜內容 -->
          <div class="tab-pane fade" id="board-content" role="tabpanel" aria-labelledby="board-tab">
            <div class="mt-4 bg-white p-4 rounded shadow-sm">
              <div class="text-center">
                <h2 class="fw-bold section-title" style="font-size: 1.75rem;">玩家積分榜</h2>
              </div>
              <div class="level-select-container">
                <label for="level-select" class="me-2">選擇榜別：</label>
                <select id="level-select" class="level-select"></select>
              </div>
              <div id="table-area" class="table-responsive"></div>
              <div id="error-msg" class="alert alert-danger d-none"></div>
            </div>
          </div>
        </div>
    </div>
    <footer class="footer">
        <p>&copy; 2025 樂玩LeaderBoard - 逢甲店. All rights reserved.</p>
    </footer>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 黑名單玩家ID陣列（請填入員工ID，例如 [1001, 1002, 1003]）
        const blacklist = [204622,107654,224638,298400];

        let allData = {};
        let currentLevel = '';

        // 讀取 leaderboard.json
        fetch('leaderboard.json')
            .then(res => {
                if (!res.ok) throw new Error("資料載入失敗");
                return res.json();
            })
            .then(json => {
                allData = json;
                const select = document.getElementById('level-select');
                select.innerHTML = '';
                const levels = Object.keys(allData);
                if (levels.length === 0) {
                    showError("尚無排行榜資料。");
                    return;
                }
                levels.forEach(level => {
                    const opt = document.createElement('option');
                    opt.value = level;
                    opt.textContent = level;
                    select.appendChild(opt);
                });
                currentLevel = select.options[0].value;
                showTable(currentLevel);
                select.addEventListener('change', function() {
                    currentLevel = this.value;
                    showTable(currentLevel);
                });
            })
            .catch(error => {
                showError("排行榜資料載入失敗，請稍後再試。");
            });

        function showError(msg) {
            const errorMsg = document.getElementById('error-msg');
            const tableArea = document.getElementById('table-area');
            if (errorMsg) {
                errorMsg.classList.remove('d-none');
                errorMsg.innerText = msg;
            }
            if (tableArea) tableArea.innerHTML = '';
        }

        function showTable(level) {
            const tableArea = document.getElementById('table-area');
            const errorMsg = document.getElementById('error-msg');
            tableArea.innerHTML = '';
            errorMsg.classList.add('d-none');
            if (!allData[level] || allData[level].length === 0) {
                showError("目前沒有可顯示的排行榜資料。");
                return;
            }
            // 過濾黑名單
            const filteredRows = allData[level].filter(row => !blacklist.includes(row['玩家ID']));
            if (filteredRows.length === 0) {
                showError("目前沒有可顯示的排行榜資料。");
                return;
            }
            // 按分數高低排序（'當日總分'欄位請依你的 leaderboard.json 欄位名稱調整）
            filteredRows.sort((a, b) => b['當日總分'] - a['當日總分']);
            // 重新編號排名
            filteredRows.forEach((row, idx) => row['排名'] = idx + 1);

            // 顯示欄位：排名 + 原本前三欄
            const showKeys = ['排名', '玩家ID', '總積分'];
            let html = '<table class="table table-striped"><thead><tr>';
            showKeys.forEach(key => {
                html += `<th>${key}</th>`;
            });
            html += '</tr></thead><tbody>';
            filteredRows.forEach(row => {
                html += '<tr>';
                showKeys.forEach(key => {
                    html += `<td>${row[key] !== undefined ? row[key] : ''}</td>`;
                });
                html += '</tr>';
            });
            html += '</tbody></table>';
            tableArea.innerHTML = html;
        }
    </script>
</body>
</html>

